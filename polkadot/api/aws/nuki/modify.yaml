---

modify_choices_:
  type: checkbox
  message: Which deployments do you want to modify?
  choices: "{{ nuki.deployment_list_ }}"
  when: "{{ 'modify' in nuki.action_ }}"

modify_read_:
  type: yaml
  path: "deployments/{{nuki.item}}"
  loop: "{{ nuki.modify_choices_ }}"
  when: "{{ 'modify' in nuki.action_ }}"

modify_write_:
  type: yaml
  path: "deployments/{{nuki.item}}"
  contents: "{{ nuki.modify_prompt_ }}"
  loop: "{{ nuki.modify_choices_ }}"
  when: "{{ 'modify' in nuki.action_ }}"

modify_existing_options_:
  type: checkbox
  message: What components do you want to modify?
  when: "{{ 'modify_existing' in nuki.action_ }}"
  choices:
    - network: Network
    - asg: Autoscaling group
    - k8s-cluster: Kubernetes Cluster
    - k8s-config: Kubernetes Applications

network:
  type: nukikata
  template: .
  when: "{{ 'network' in nuki.modify_existing_options_ }}"
  chdir: /home/rob/go/src/github.com/insight-w3f/aws/terraform-polkadot-aws-network
  merge: true
  existing_context: "{{nuki.region}}"

asg:
  type: nukikata
  template: .
  #      checkout: "{{ nuki.version_[nuki.environment] }}"
  #      template: .
  merge: true
  when: "{{ 'k8s-cluster' in nuki.modify_existing_options_ }}"
  chdir: /home/rob/go/src/github.com/insight-w3f/aws/terraform-polkadot-aws-k8s-cluster
  existing_context: "{{nuki.region}}"

k8s-cluster:
  type: nukikata
  template: .
  #      checkout: "{{ nuki.version_[nuki.environment] }}"
  #      template: .
  merge: true
  when: "{{ 'k8s-cluster' in nuki.modify_existing_options_ }}"
  chdir: /home/rob/go/src/github.com/insight-w3f/aws/terraform-polkadot-aws-k8s-cluster
  existing_context: "{{nuki.region}}"

k8s-config:
  type: nukikata
  template: .
  #      checkout: "{{ nuki.version_[nuki.environment] }}"
  #      template: .
  merge: true
  when: "{{ 'k8s-config' in nuki.modify_existing_options_ }}"
  chdir: /home/rob/go/src/github.com/insight-w3f/aws/terraform-polkadot-aws-k8s-cluster
  existing_context: "{{nuki.region}}"

